package io.github.raze.modules.collection.misc;

import io.github.raze.events.collection.network.EventPacketReceive;
import io.github.nevalackin.radbus.Listen;
import io.github.raze.modules.system.AbstractModule;
import io.github.raze.modules.system.information.ModuleCategory;
import net.minecraft.network.play.client.C19PacketResourcePackStatus;
import net.minecraft.network.play.server.S48PacketResourcePackSend;

public class AntiResourceExploit extends AbstractModule {

    public AntiResourceExploit() {
        super("AntiResourceExploit", "Patches the resource exploit that is used to look at your .minecraft folder.", ModuleCategory.MISC);
    }

    @Listen
    public void onPacket(EventPacketReceive eventPacketReceive) {
        if (eventPacketReceive.getPacket() instanceof S48PacketResourcePackSend) {
            mc.thePlayer.sendQueue.addToSendQueue(new C19PacketResourcePackStatus(
                    ((S48PacketResourcePackSend) eventPacketReceive.getPacket()).getHash(),
                    C19PacketResourcePackStatus.Action.FAILED_DOWNLOAD)
            );

            eventPacketReceive.setCancelled(true);
        }
    }

}
